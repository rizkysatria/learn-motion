<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Hand Motion Tracking</title>
  <style>
  body {
    margin: 0;
    overflow: hidden;
    background: black;
  }
  canvas {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 10;
  }
  video {
    display: none; /* kamera disembunyiin */
  }
</style>
</head>
<body>

<video id="video" autoplay playsinline style="display:none"></video>
<canvas id="canvas"></canvas>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1675469240/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils@0.3.1675466862/camera_utils.js"></script> 
<script>
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  const video = document.getElementById("video");

  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener("resize", resize);

  let objX = canvas.width / 2;
  let objY = canvas.height / 2;

  const smooth = 0.25;
  let targetX = objX;
  let targetY = objY;

  // MediaPipe
  const hands = new Hands({
    locateFile: (file) => {
        return `https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1675469240/${file}`;
    }
  });

  hands.setOptions({
    maxNumHands: 1,
    minDetectionConfidence: 0.6,
    minTrackingConfidence: 0.6,
  });

  hands.onResults((results) => {
  console.log("hands results:", results);

  if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
    const index = results.multiHandLandmarks[0][8];
    targetX = index.x * canvas.width;
    targetY = index.y * canvas.height;
  }
});

  const camera = new Camera(video, {
    onFrame: async () => {
      await hands.send({ image: video });
    },
    width: 640,
    height: 480,
  });

  camera.start();

  function draw() {
    // background gelap
    ctx.fillStyle = "black";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // smoothing movement
    objX += (targetX - objX) * smooth;
    objY += (targetY - objY) * smooth;

    // object
    ctx.beginPath();
    ctx.arc(objX, objY, 30, 0, Math.PI * 2);
    ctx.fillStyle = "#00ff88";
    ctx.fill();

    requestAnimationFrame(draw);
  }

  draw();
</script>

</body>
</html>